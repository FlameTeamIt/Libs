cmake_minimum_required(VERSION 3.14)
get_sources(FILE_LIST)

set(NAME "Crypto.Pkcs11")
set(SUBALIAS_NAME "Crypto::Pkcs11")
set(INCLUDE_PATHS ${FLAME_INCLUDE_PATH})

set(DEPENDENCY_HEADER_TARGETS
	"${FLAME_NAMESPACE}::Crypto::Pkcs11::Headers"
	"${FLAME_NAMESPACE}::Threads::Headers"
)
set(DEPENDENCY_TARGETS_FOR_STATIC
	"${FLAME_NAMESPACE}::Threads::Static"
	"${FLAME_NAMESPACE}::Crypto::Pkcs11::MutexReal::Object"
)
set(DEPENDENCY_TARGETS_FOR_SHARED
	"${FLAME_NAMESPACE}::Threads::Shared"
	"${FLAME_NAMESPACE}::Crypto::Pkcs11::MutexReal::Object"
)

if(FLAME_MAKE_STATIC)
	set(MAKE_STATIC MAKE_STATIC)
endif()
if(FLAME_MAKE_SHARED)
	set(MAKE_SHARED MAKE_SHARED)
endif()

flame_compile_library(
	NAME "${NAME}"
	SOURCE_LIST "${FILE_LIST}"
	INCLUDE_PATHS "${INCLUDE_PATHS}"
	DEPENDENCY_HEADER_TARGETS     "${DEPENDENCY_HEADER_TARGETS}"
	DEPENDENCY_TARGETS_FOR_STATIC "${DEPENDENCY_TARGETS_FOR_STATIC}"
	DEPENDENCY_TARGETS_FOR_SHARED "${DEPENDENCY_TARGETS_FOR_SHARED}"
	OBJECT_ALIAS_NAME "${FLAME_NAMESPACE}::${NAME}::Object"
	INDEPENDENT_OBJECT_ALIAS_NAME
		"${FLAME_NAMESPACE}::${SUBALIAS_NAME}::Object::Independ"
	STATIC_ALIAS_NAME "${FLAME_NAMESPACE}::${SUBALIAS_NAME}::Static"
	SHARED_ALIAS_NAME "${FLAME_NAMESPACE}::${SUBALIAS_NAME}::Shared"

	NO_RTTI
	NO_EXCEPTIONS

	${MAKE_SHARED}
	${MAKE_STATIC}
)

set(NAME "Crypto.Pkcs11.NoThread")
set(SUBALIAS_NAME "Crypto::Pkcs11::NoThread")
set(DEPENDENCY_HEADER_TARGETS
	"${FLAME_NAMESPACE}::Crypto::Pkcs11::Headers"
)
set(DEPENDENCY_TARGETS_FOR_STATIC
	"${FLAME_NAMESPACE}::Crypto::Pkcs11::MutexStub::Object"
)
set(DEPENDENCY_TARGETS_FOR_SHARED
	"${FLAME_NAMESPACE}::Crypto::Pkcs11::MutexStub::Object::Independ"
)
flame_compile_library(
	NAME "${NAME}"
	SOURCE_LIST "${FILE_LIST}"
	INCLUDE_PATHS "${INCLUDE_PATHS}"
	DEPENDENCY_HEADER_TARGETS "${DEPENDENCY_HEADER_TARGETS}"
	OBJECT_ALIAS_NAME "${FLAME_NAMESPACE}::${SUBALIAS_NAME}::Object"
	INDEPENDENT_OBJECT_ALIAS_NAME
		"${FLAME_NAMESPACE}::${SUBALIAS_NAME}::Object::Independ"
	STATIC_ALIAS_NAME "${FLAME_NAMESPACE}::${SUBALIAS_NAME}::Static"
	SHARED_ALIAS_NAME "${FLAME_NAMESPACE}::${SUBALIAS_NAME}::Shared"

	NO_RTTI
	NO_EXCEPTIONS

	${MAKE_SHARED}
	${MAKE_STATIC}
)
