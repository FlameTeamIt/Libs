set(NAME THREADS)

set(SOURCE_LIST)
set(TESTS_SOURCE_LIST)

add_cpp_sources(${CMAKE_CURRENT_SOURCE_DIR} SOURCE_LIST)

set(DIRS ${CMAKE_CURRENT_SOURCE_DIR})
add_cpp_sources(${CMAKE_CURRENT_SOURCE_DIR}/Tests TESTS_SOURCE_LIST)
if (UNIX)
	set(DIRS ${DIRS} ${CMAKE_CURRENT_SOURCE_DIR}/Posix)
endif (UNIX)
if (WIN32)
	set(DIRS ${DIRS} ${CMAKE_CURRENT_SOURCE_DIR}/Windows)
endif (WIN32)

foreach (DIR ${DIRS})
	set(SOURCE_LIST_TEMP)
	add_cpp_sources(${DIR} SOURCE_LIST_TEMP)
	set(SOURCE_LIST ${SOURCE_LIST} ${SOURCE_LIST_TEMP})
endforeach ()

add_cpp_sources(${CMAKE_CURRENT_SOURCE_DIR}/Tests TESTS_SOURCE_LIST)

set(${NAME}_SOURCE_LIST ${SOURCE_LIST} PARENT_SCOPE)
set(${NAME}_TESTS_SOURCE_LIST ${TESTS_SOURCE_LIST} PARENT_SCOPE)
