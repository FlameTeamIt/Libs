cmake_minimum_required(VERSION 3.14)
project(Flame)

set(CMAKE_MAIN_TARGET_NAME ${CMAKE_PROJECT_NAME})
set(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} ${CMAKE_CURRENT_SOURCE_DIR}/cmake)

set(FLAME_NAMESPACE ${PROJECT_NAME})
set(FLAME_INCLUDE_PATH ${CMAKE_CURRENT_SOURCE_DIR}/include)
set(FLAME_INCLUDE_TEST_PATH ${CMAKE_CURRENT_SOURCE_DIR})
set(FLAME_CURRENT_DIR ${CMAKE_CURRENT_SOURCE_DIR})

set(FLAME_INCLUDE_SUBMODLUES_PATH ${FLAME_INCLUDE_PATH}/FlameIDE)
set(FLAME_SOURCE_SUBMODLUES_PATH ${CMAKE_CURRENT_SOURCE_DIR}/src)
set(FLAME_TEST_SUBMODLUES_PATH ${CMAKE_CURRENT_SOURCE_DIR}/tests)

include(FlameContrib)
include(CmakeFlameResolver)

function(get_sources OUTPUT_NAME)
	set(SOURCE_FILE "${CMAKE_CURRENT_SOURCE_DIR}/Sources.cmake")
	if(EXISTS ${SOURCE_FILE})
		include(${SOURCE_FILE})
		list(APPEND FILE_LIST ${SOURCE_LIST})
		unset(SOURCE_LIST)
	endif()

	set(HEADER_FILE "${CMAKE_CURRENT_SOURCE_DIR}/Headers.cmake")
	if(EXISTS ${HEADER_FILE})
		include(${HEADER_FILE})
		list(APPEND FILE_LIST ${HEADER_LIST})
		unset(HEADER_LIST)
	endif()

	set(${OUTPUT_NAME} ${FILE_LIST} PARENT_SCOPE)
endfunction()

add_subdirectory(${FLAME_INCLUDE_SUBMODLUES_PATH})
add_subdirectory(${FLAME_SOURCE_SUBMODLUES_PATH})
add_subdirectory(${FLAME_TEST_SUBMODLUES_PATH})

flame_resolve_targets()
